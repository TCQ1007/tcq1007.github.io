<template>
    <div style="background: #0a0e27; min-height: 100vh; color: #e2e8f0;">
        <!-- Hero Section -->
        <section
            style="background: linear-gradient(135deg, #1a202c 0%, #2d3748 50%, #4a5568 100%); color: #f7fafc; padding: 4rem 0; text-align: center; position: relative; overflow: hidden;">
            <!-- æŠ€æœ¯èƒŒæ™¯è£…é¥° -->
            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.1;">
                <div
                    style="position: absolute; top: 20%; left: 10%; width: 100px; height: 100px; border: 2px solid #63b3ed; border-radius: 50%; animation: float 6s ease-in-out infinite;">
                </div>
                <div
                    style="position: absolute; top: 60%; right: 15%; width: 80px; height: 80px; border: 2px solid #68d391; transform: rotate(45deg); animation: float 8s ease-in-out infinite reverse;">
                </div>
                <div
                    style="position: absolute; bottom: 30%; left: 20%; width: 60px; height: 60px; border: 2px solid #f6ad55; border-radius: 10px; animation: float 7s ease-in-out infinite;">
                </div>
            </div>

            <div style="max-width: 1200px; margin: 0 auto; padding: 0 2rem; position: relative; z-index: 1;">
                <h1
                    style="font-size: 3.5rem; font-weight: 800; margin-bottom: 1rem; background: linear-gradient(45deg, #63b3ed, #68d391, #f6ad55); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    TCQ1007 çš„æŠ€æœ¯åšå®¢
                </h1>
                <p
                    style="font-size: 1.25rem; margin-bottom: 2rem; color: #ffffff; font-weight: 400; text-shadow: 0 1px 2px rgba(0,0,0,0.5);">
                    åŸºäº Nuxt 3 å’Œ GitHub Pages çš„ç°ä»£åŒ–åšå®¢å¹³å°
                </p>
                <div style="display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;">
                    <span
                        style="padding: 0.5rem 1rem; background: rgba(99, 179, 237, 0.2); border: 1px solid #63b3ed; border-radius: 20px; font-size: 0.875rem; color: #63b3ed;">
                        ğŸš€ ç°ä»£åŒ–
                    </span>
                    <span
                        style="padding: 0.5rem 1rem; background: rgba(104, 211, 145, 0.2); border: 1px solid #68d391; border-radius: 20px; font-size: 0.875rem; color: #68d391;">
                        âš¡ é«˜æ€§èƒ½
                    </span>
                    <span
                        style="padding: 0.5rem 1rem; background: rgba(246, 173, 85, 0.2); border: 1px solid #f6ad55; border-radius: 20px; font-size: 0.875rem; color: #f6ad55;">
                        ğŸŒ GitHub Pages
                    </span>
                </div>
            </div>
        </section>

        <!-- å¤–é“¾å·¥å…·åŒºåŸŸ -->
        <div style="max-width: 1200px; margin: 0 auto; padding: 3rem 2rem 2rem;">
            <div style="margin-bottom: 4rem;">
                <h2
                    style="font-size: 1.75rem; font-weight: 700; color: #ffffff; margin-bottom: 2rem; text-align: center; text-shadow: 0 1px 2px rgba(0,0,0,0.5);">
                    ğŸ”— å®ç”¨å·¥å…·
                </h2>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
                    <a v-for="link in externalLinks" :key="link.url" :href="link.url" target="_blank"
                        rel="noopener noreferrer"
                        style="background: linear-gradient(145deg, #2d3748, #4a5568); border: 1px solid #4a5568; border-radius: 12px; padding: 1.5rem; text-decoration: none; transition: all 0.3s ease; display: block; position: relative; overflow: hidden;"
                        @mouseover="$event.currentTarget.style.transform = 'translateY(-4px)'; $event.currentTarget.style.boxShadow = '0 20px 40px rgba(0,0,0,0.3)'"
                        @mouseout="$event.currentTarget.style.transform = 'translateY(0)'; $event.currentTarget.style.boxShadow = 'none'">
                        <!-- å›¾æ ‡ -->
                        <div style="font-size: 2rem; margin-bottom: 1rem;">{{ link.icon }}</div>

                        <!-- æ ‡é¢˜ -->
                        <h3 style="color: #ffffff; font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem;">
                            {{ link.title }}
                        </h3>

                        <!-- æè¿° -->
                        <p
                            style="color: #e2e8f0; font-size: 0.875rem; line-height: 1.5; margin-bottom: 1rem; opacity: 0.9;">
                            {{ link.description }}
                        </p>

                        <!-- æ ‡ç­¾ -->
                        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                            <span v-for="tag in link.tags" :key="tag"
                                style="padding: 0.25rem 0.5rem; background: rgba(99, 179, 237, 0.2); color: #63b3ed; font-size: 0.75rem; border-radius: 8px; border: 1px solid rgba(99, 179, 237, 0.3);">
                                {{ tag }}
                            </span>
                        </div>

                        <!-- å¤–é“¾å›¾æ ‡ -->
                        <div style="position: absolute; top: 1rem; right: 1rem; color: #a0aec0; font-size: 1rem;">
                            â†—
                        </div>
                    </a>
                </div>
            </div>
        </div>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <div style="max-width: 1200px; margin: 0 auto; padding: 0 2rem 3rem;">
            <!-- ä¸»æ ç›®å¯¼èˆª -->
            <div style="display: flex; justify-content: center; gap: 1rem; margin-bottom: 3rem;">
                <button @click="activeSection = 'blog'" :style="{
                    padding: '1rem 2rem',
                    borderRadius: '12px',
                    border: 'none',
                    fontWeight: '700',
                    fontSize: '1rem',
                    cursor: 'pointer',
                    transition: 'all 0.3s ease',
                    background: activeSection === 'blog' ? 'linear-gradient(45deg, #63b3ed, #68d391)' : 'rgba(45, 55, 72, 0.8)',
                    color: activeSection === 'blog' ? '#1a202c' : '#e2e8f0',
                    boxShadow: activeSection === 'blog' ? '0 8px 25px rgba(99, 179, 237, 0.3)' : 'none',
                    transform: activeSection === 'blog' ? 'translateY(-2px)' : 'translateY(0)'
                }">
                    ğŸ“ åšå®¢æ–‡ç« 
                </button>
                <button @click="activeSection = 'docs'" :style="{
                    padding: '1rem 2rem',
                    borderRadius: '12px',
                    border: 'none',
                    fontWeight: '700',
                    fontSize: '1rem',
                    cursor: 'pointer',
                    transition: 'all 0.3s ease',
                    background: activeSection === 'docs' ? 'linear-gradient(45deg, #63b3ed, #68d391)' : 'rgba(45, 55, 72, 0.8)',
                    color: activeSection === 'docs' ? '#1a202c' : '#e2e8f0',
                    boxShadow: activeSection === 'docs' ? '0 8px 25px rgba(99, 179, 237, 0.3)' : 'none',
                    transform: activeSection === 'docs' ? 'translateY(-2px)' : 'translateY(0)'
                }">
                    ğŸ“š é¡¹ç›®æ–‡æ¡£
                </button>
            </div>

            <!-- åšå®¢æ–‡ç« åŒºåŸŸ -->
            <div v-show="activeSection === 'blog'">
                <!-- åˆ†ç±»å¯¼èˆª -->
                <div style="display: flex; justify-content: center; gap: 1rem; margin-bottom: 3rem; flex-wrap: wrap;">
                    <button v-for="category in categories" :key="category.name" @click="activeCategory = category.name"
                        :style="{
                            padding: '0.75rem 1.5rem',
                            borderRadius: '8px',
                            border: 'none',
                            cursor: 'pointer',
                            fontWeight: '600',
                            fontSize: '0.875rem',
                            transition: 'all 0.3s ease',
                            background: activeCategory === category.name ? category.color : 'rgba(45, 55, 72, 0.8)',
                            color: activeCategory === category.name ? '#1a202c' : '#e2e8f0',
                            boxShadow: activeCategory === category.name ? `0 4px 12px ${category.color}40` : 'none'
                        }">
                        {{ category.icon }} {{ category.name }}
                        <span
                            style="margin-left: 0.5rem; padding: 0.25rem 0.5rem; background: rgba(0,0,0,0.2); border-radius: 12px; font-size: 0.75rem;">
                            {{ category.count }}
                        </span>
                    </button>
                </div>

                <!-- åŠ è½½çŠ¶æ€ -->
                <div v-if="pending" style="text-align: center; padding: 3rem 0;">
                    <div
                        style="width: 3rem; height: 3rem; border: 2px solid #4a5568; border-top: 2px solid #63b3ed; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;">
                    </div>
                    <p style="margin-top: 1rem; color: #f7fafc; font-weight: 500;">åŠ è½½ä¸­...</p>
                </div>

                <!-- é”™è¯¯çŠ¶æ€ -->
                <div v-else-if="error" style="text-align: center; padding: 3rem 0;">
                    <div
                        style="padding: 2rem; background: rgba(245, 101, 101, 0.2); border: 1px solid #f56565; border-radius: 8px; max-width: 500px; margin: 0 auto;">
                        <p style="color: #fed7d7; font-weight: 600; font-size: 1.1rem;">âš ï¸ åŠ è½½æ–‡ç« æ—¶å‡ºé”™</p>
                        <p style="margin-top: 0.5rem; font-size: 0.875rem; color: #f7fafc;">{{ error }}</p>
                    </div>
                </div>

                <!-- æ–‡ç« åˆ—è¡¨ -->
                <div v-else-if="filteredArticles && filteredArticles.length > 0">
                    <h2
                        style="font-size: 1.75rem; font-weight: 700; color: #ffffff; margin-bottom: 2rem; text-align: center; text-shadow: 0 1px 2px rgba(0,0,0,0.5);">
                        {{ getCategoryInfo(activeCategory).icon }} {{ activeCategory }}
                        <span
                            style="font-size: 1rem; color: #ffffff; font-weight: 500; margin-left: 0.5rem; opacity: 0.8;">
                            ({{ filteredArticles.length }} ç¯‡æ–‡ç« )
                        </span>
                    </h2>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 2rem;">
                        <ContentCard v-for="article in filteredArticles" :key="article.path" :content="article"
                            type="blog" />
                    </div>
                </div>

                <!-- ç©ºçŠ¶æ€ -->
                <div v-else style="text-align: center; padding: 4rem 0;">
                    <div style="max-width: 400px; margin: 0 auto;">
                        <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ“</div>
                        <h3 style="color: #ffffff; font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem;">
                            {{ activeCategory }} åˆ†ç±»æš‚æ— æ–‡ç« 
                        </h3>
                        <p style="color: #ffffff; margin-bottom: 2rem; opacity: 0.8;">
                            æ•¬è¯·æœŸå¾…æ›´å¤šç²¾å½©å†…å®¹
                        </p>
                        <button @click="activeCategory = 'å…¨éƒ¨'"
                            style="padding: 0.75rem 1.5rem; background: linear-gradient(45deg, #63b3ed, #68d391); color: #1a202c; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: transform 0.2s ease;"
                            @mouseover="$event.target.style.transform = 'scale(1.05)'"
                            @mouseout="$event.target.style.transform = 'scale(1)'">
                            æŸ¥çœ‹å…¨éƒ¨æ–‡ç« 
                        </button>
                    </div>
                </div>
            </div>

            <!-- é¡¹ç›®æ–‡æ¡£åŒºåŸŸ -->
            <div v-show="activeSection === 'docs'">
                <h2
                    style="font-size: 1.75rem; font-weight: 700; color: #ffffff; margin-bottom: 2rem; text-align: center; text-shadow: 0 1px 2px rgba(0,0,0,0.5);">
                    ğŸ“š é¡¹ç›®æ–‡æ¡£
                </h2>

                <!-- æ–‡æ¡£åˆ—è¡¨ -->
                <div v-if="docs && docs.length"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 1.5rem;">
                    <ContentCard v-for="doc in docs" :key="doc.path" :content="doc" type="docs" />
                </div>

                <!-- æ–‡æ¡£ç©ºçŠ¶æ€ -->
                <div v-else style="text-align: center; padding: 4rem 0;">
                    <div style="max-width: 400px; margin: 0 auto;">
                        <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ“š</div>
                        <h3 style="color: #ffffff; font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem;">
                            æ–‡æ¡£æ­£åœ¨æ•´ç†ä¸­
                        </h3>
                        <p style="color: #ffffff; margin-bottom: 2rem; opacity: 0.8;">
                            é¡¹ç›®æ–‡æ¡£å³å°†ä¸Šçº¿ï¼Œæ•¬è¯·æœŸå¾…
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<script setup>
// ç§»é™¤æ‰‹åŠ¨å¯¼å…¥ï¼Œä¾èµ–è‡ªåŠ¨å¯¼å…¥

// è®¾ç½®é¡µé¢å…ƒæ•°æ®
useHead({
    title: 'TCQ1007 çš„æŠ€æœ¯åšå®¢ - åŸºäº Nuxt 3 å’Œ GitHub Pages',
    meta: [
        {
            name: 'description',
            content: 'TCQ1007 çš„æŠ€æœ¯åšå®¢ï¼ŒåŸºäº Nuxt 3 å’Œ GitHub Pages çš„ç°ä»£åŒ–æŠ€æœ¯åšå®¢å¹³å°ï¼Œåˆ†äº«å‰ç«¯å¼€å‘ã€å…¨æ ˆæŠ€æœ¯å’Œäº‘è®¡ç®—ç›¸å…³å†…å®¹ã€‚'
        },
        {
            property: 'og:title',
            content: 'TCQ1007 çš„æŠ€æœ¯åšå®¢ - åŸºäº Nuxt 3 å’Œ GitHub Pages'
        },
        {
            property: 'og:description',
            content: 'TCQ1007 çš„æŠ€æœ¯åšå®¢ï¼ŒåŸºäº Nuxt 3 å’Œ GitHub Pages çš„ç°ä»£åŒ–æŠ€æœ¯åšå®¢å¹³å°'
        },
        {
            property: 'og:type',
            content: 'website'
        }
    ]
})

// å¤–é“¾å·¥å…·é…ç½®
const externalLinks = ref([
    {
        title: 'Mermaid å›¾è¡¨å·¥å…·',
        description: 'åœ¨çº¿åˆ›å»ºå’Œç¼–è¾‘ Mermaid å›¾è¡¨ï¼Œæ”¯æŒæµç¨‹å›¾ã€æ—¶åºå›¾ã€ç”˜ç‰¹å›¾ç­‰å¤šç§å›¾è¡¨ç±»å‹ã€‚',
        url: 'https://mermaid.will-tecth.workers.dev/',
        icon: 'ğŸ“Š',
        tags: ['å›¾è¡¨', 'Mermaid', 'å¯è§†åŒ–', 'åœ¨çº¿å·¥å…·']
    }
])

// è·å–åšå®¢æ–‡ç« åˆ—è¡¨ - ä½¿ç”¨ Nuxt Content 3 æ ‡å‡† API
const { data: articles, pending, error } = await useAsyncData('blog-articles', async () => {
    try {
        console.log('ä½¿ç”¨ Nuxt Content 3 queryCollection API æŸ¥è¯¢åšå®¢æ–‡ç« ...')

        // ä½¿ç”¨ Nuxt Content 3 çš„æ ‡å‡†æŸ¥è¯¢æ–¹å¼
        const result = await queryCollection('blog')
            .order('date', 'DESC')
            .all()

        console.log('æŸ¥è¯¢åˆ°çš„æ–‡ç« æ•°é‡:', result?.length || 0)
        console.log('æ–‡ç« åˆ—è¡¨:', result)

        // è°ƒè¯•åˆ†ç±»ä¿¡æ¯
        if (result && result.length > 0) {
            console.log('æ–‡ç« åˆ†ç±»ä¿¡æ¯:')
            result.forEach((article, index) => {
                console.log(`${index + 1}. ${article.title} - åˆ†ç±»: "${article.category}"`)
            })
        }

        return result || []
    } catch (err) {
        console.error('æŸ¥è¯¢åšå®¢æ–‡ç« æ—¶å‘ç”Ÿé”™è¯¯:', err)
        console.error('é”™è¯¯è¯¦æƒ…:', {
            message: err.message,
            stack: err.stack,
            cause: err.cause
        })

        // è¿”å›ç©ºæ•°ç»„è€Œä¸æ˜¯å›é€€åˆ° APIï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Nuxt Content 3
        return []
    }
})

// è·å–é¡¹ç›®æ–‡æ¡£åˆ—è¡¨ - ä½¿ç”¨ Nuxt Content 3 Collections API
const { data: docs } = await useAsyncData('docs', async () => {
    try {
        console.log('ä½¿ç”¨ queryCollection API æŸ¥è¯¢æ–‡æ¡£...')

        // ä½¿ç”¨ Nuxt Content 3 çš„ Collections API
        const docsData = await queryCollection('docs').all()

        console.log('æŸ¥è¯¢åˆ°çš„æ–‡æ¡£æ•°é‡:', docsData?.length || 0)
        console.log('æ–‡æ¡£åˆ—è¡¨:', docsData?.map(doc => ({ title: doc.title, path: doc.path })))

        return docsData || []
    } catch (error) {
        console.error('æŸ¥è¯¢æ–‡æ¡£æ—¶å‘ç”Ÿé”™è¯¯:', error)
        return []
    }
})

// ä¸»æ ç›®åˆ‡æ¢çŠ¶æ€
const activeSection = ref('blog')

// åˆ†ç±»ç®¡ç†
const activeCategory = ref('å…¨éƒ¨')

// åˆ†ç±»é…ç½®
const categoryConfig = {
    'å…¨éƒ¨': { icon: 'ğŸ“š', color: '#63b3ed' },
    'æ–¹æ¡ˆè®¾è®¡': { icon: 'ğŸ—ï¸', color: '#68d391' },
    'æŠ€æœ¯è¯´æ˜': { icon: 'âš™ï¸', color: '#f6ad55' },
    'AIç›¸å…³': { icon: 'ğŸ¤–', color: '#ed64a6' }
}

// è®¡ç®—åˆ†ç±»ç»Ÿè®¡
const categories = computed(() => {
    const allArticles = articles.value || []

    return [
        {
            name: 'å…¨éƒ¨',
            icon: categoryConfig['å…¨éƒ¨'].icon,
            color: categoryConfig['å…¨éƒ¨'].color,
            count: allArticles.length
        },
        {
            name: 'æ–¹æ¡ˆè®¾è®¡',
            icon: categoryConfig['æ–¹æ¡ˆè®¾è®¡'].icon,
            color: categoryConfig['æ–¹æ¡ˆè®¾è®¡'].color,
            count: allArticles.filter(article => article.category === 'æ–¹æ¡ˆè®¾è®¡').length
        },
        {
            name: 'æŠ€æœ¯è¯´æ˜',
            icon: categoryConfig['æŠ€æœ¯è¯´æ˜'].icon,
            color: categoryConfig['æŠ€æœ¯è¯´æ˜'].color,
            count: allArticles.filter(article => article.category === 'æŠ€æœ¯è¯´æ˜').length
        },
        {
            name: 'AIç›¸å…³',
            icon: categoryConfig['AIç›¸å…³'].icon,
            color: categoryConfig['AIç›¸å…³'].color,
            count: allArticles.filter(article => article.category === 'AIç›¸å…³').length
        }
    ]
})

// è¿‡æ»¤æ–‡ç« 
const filteredArticles = computed(() => {
    if (!articles.value) return []

    if (activeCategory.value === 'å…¨éƒ¨') {
        return articles.value
    }

    return articles.value.filter(article => article.category === activeCategory.value)
})

// è·å–åˆ†ç±»ä¿¡æ¯
const getCategoryInfo = (category) => {
    return categoryConfig[category] || categoryConfig['å…¨éƒ¨']
}


</script>

<style scoped>
/* æŠ€æœ¯åŒ–åŠ¨ç”»æ•ˆæœ */
@keyframes float {
    0%, 100% {
        transform: translateY(0px);
    }

    50% {
        transform: translateY(-20px);
    }
}

@keyframes spin {
    from {
        transform: rotate(0deg);
    }

    to {
        transform: rotate(360deg);
    }
}

@keyframes pulse {
    0%, 100% {
        opacity: 1;
    }

    50% {
        opacity: 0.5;
    }
}

@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ç½‘æ ¼èƒŒæ™¯æ•ˆæœ */
.tech-grid {
    background-image:
        linear-gradient(rgba(99, 179, 237, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(99, 179, 237, 0.1) 1px, transparent 1px);
    background-size: 50px 50px;
}

/* æ‚¬æµ®æ•ˆæœ */
.hover-lift {
    transition: all 0.3s ease;
}

.hover-lift:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
}

/* æ¸å˜è¾¹æ¡†æ•ˆæœ */
.gradient-border {
    position: relative;
    background: linear-gradient(145deg, #2d3748, #4a5568);
    border-radius: 12px;
}

.gradient-border::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 12px;
    padding: 1px;
    background: linear-gradient(45deg, #63b3ed, #68d391, #f6ad55, #ed64a6);
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask-composite: exclude;
    -webkit-mask-composite: xor;
}

/* ä»£ç é£æ ¼å­—ä½“ */
.code-font {
    font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', 'Monaco', monospace;
}

/* æŠ€æœ¯æ ‡ç­¾æ ·å¼ */
.tech-tag {
    position: relative;
    overflow: hidden;
}

.tech-tag::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
}

.tech-tag:hover::before {
    left: 100%;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .hero-title {
        font-size: 2.5rem !important;
    }

    .category-grid {
        grid-template-columns: 1fr !important;
    }

    .article-grid {
        grid-template-columns: 1fr !important;
    }
}

/* æ»šåŠ¨æ¡æ ·å¼ */
::-webkit-scrollbar {
    width: 8px;
}

::-webkit-scrollbar-track {
    background: #2d3748;
}

::-webkit-scrollbar-thumb {
    background: #4a5568;
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: #63b3ed;
}
</style>

<style>
@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

body {
    margin: 0;
    padding: 0;
    background-color: #f8fafc;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
}
</style>
